# MedLP---HAFB---CLIP
Level II ultrasound standard section classification is of great importance for accurate prenatal diagnosis. However, sonographers faces challenges for distinguishing  the lateral ventricle  transverse section and  the thalamus transverse section.  In this study, the standard section images of second-trimester fetal Level II prenatal ultrasound examinations from 1261 pregnant women are collected, and a section classification model called MedLP-HAFB-CLIP is proposed. The model employs a meticulously designed prompt learner to generate prompts that are highly compatible with anatomical categories, effectively integrating medical knowledge. By combining fine-grained anatomical descriptions and a customized loss function, the model's discriminative ability for complex image features is significantly enhanced. Additionally, the Hierarchical Adaptive Feature Block (HAFB) module is proposed for multi-scale feature extraction and adaptive fusion, further improving the model's classification performance. Experimental results demonstrate that  MedLP-HAFB-CLIP significantly outperforms baseline models. It exhibits excellent performance in distinguishing the lateral ventricle  transverse section and  the thalamus transverse section. Moreover, observational experiments show that the model achieves an accuracy of 100\%, outperforms junior and senior sonographers, and significantly improves the diagnostic efficiency and accuracy of sonographers.

胎儿超声图像分类对于准确的产前诊断至关重要，然而该领域面临着图像质量欠佳、解剖结构复杂、数据异构性以及模型局限性等诸多挑战。本研究采集来自 1261 名孕妇的中孕期胎儿 II 级产前超声检查标准切面图，并基于此提出了 MedLP - HAFB - CLIP 模型，旨在提升胎儿超声图像的分类性能。该模型通过精心设计的提示词学习器，生成与解剖学类别高度匹配的提示词，从而有效融入医学知识。同时，结合细粒度的解剖学描述以及定制的损失函数，显著增强了模型对复杂图像特征的判别能力。此外，引入 HAFB 模块进行多尺度特征提取和自适应融合，进一步提升了模型的分类性能。为了处理数据不平衡等问题，还采用了过采样和数据标准化等数据处理方法。实验结果表明，MedLP - HAFB - CLIP 模型在分类准确率（0.993）、精确率（0.991）、召回率（0.992）和 F1 分数（0.992）等关键指标上，均显著优于 Swin Transformer、EfficientNet 等对比模型。特别是在区分侧脑室横切面和丘脑横切面等相似解剖结构图像时，该模型表现出了卓越的性能。消融实验充分验证了模型各组件的有效性。此外，观察实验显示该模型不仅自身准确率可达 100%，还能够显著提升不同经验水平放射科医生的诊断效率和准确率。本研究为胎儿超声图像分类提供了一种高效且可靠的解决方案，未来可通过进一步扩大数据集、融合新兴技术等方式，对模型进行持续优化。代码可在 https://github.com/Chenan7/MedLP---HAFB---CLIP.git 获取。
关键词：胎儿超声图像分类；医学可学习提示策略；层次自适应特征模块；多模态学习；临床应用
